
PROGRAM_1 = "12 05 43 38 50 60 00 85 00 c0 38 81 50 a5 b0 f1 1e f0 55 60 00 85 00 c0 18 81 50 a5 b8 f1 1e f0 55 60 00 a5 b0 f0 1e f0 65 8a 00 60 00 a5 b8 f0 1e f0 65 8b 00 60 00 a5 80 f0 1e da b8 60 01 a5 c2 f0 55 60 07 a5 c4 f0 55 a5 c2 f0 65 85 00 c0 38 81 50 a5 b0 f1 1e f0 55 60 00 a5 c1 f0 55 a5 c2 f0 65 85 00 60 01 81 00 80 50 80 15 a5 c6 f0 55 a5 c2 f0 65 a5 b0 f0 1e f0 65 85 00 a5 c1 f0 65 a5 b0 f0 1e f0 65 86 00 60 08 81 00 80 60 80 14 81 00 80 50 82 00 80 15 80 20 3f 00 12 db a5 c2 f0 65 a5 b0 f0 1e f0 65 85 00 a5 c1 f0 65 a5 b0 f0 1e f0 65 86 00 60 08 81 00 80 60 80 15 81 00 80 50 82 10 81 05 81 20 3f 00 12 d5 60 01 a5 c3 f0 55 12 db 60 00 a5 c3 f0 55 a5 c1 f0 65 85 00 a5 c6 f0 65 81 00 80 50 82 10 81 05 81 20 90 10 6f 00 3f 01 13 01 a5 c1 f0 65 70 01 f0 55 12 71 a5 c3 f0 65 85 00 60 01 81 50 50 10 6f 01 3f 00 13 23 a5 c2 f0 65 85 00 c0 78 81 50 a5 b0 f1 1e f0 55 a5 c3 f0 65 85 00 60 00 81 50 50 10 6f 01 90 10 6f 00 3f 00 12 59 a5 c2 f0 65 85 00 c0 18 81 50 a5 b8 f1 1e f0 55 60 00 a5 c1 f0 55 a5 c2 f0 65 85 00 60 01 81 00 80 50 80 15 a5 c6 f0 55 a5 c2 f0 65 a5 b8 f0 1e f0 65 85 00 a5 c1 f0 65 a5 b8 f0 1e f0 65 86 00 60 08 81 00 80 60 80 14 81 00 80 50 82 00 80 15 80 20 3f 00 13 cb a5 c2 f0 65 a5 b8 f0 1e f0 65 85 00 a5 c1 f0 65 a5 b8 f0 1e f0 65 86 00 60 08 81 00 80 60 80 15 81 00 80 50 82 10 81 05 81 20 3f 00 13 c5 60 01 a5 c3 f0 55 13 cb 60 00 a5 c3 f0 55 a5 c1 f0 65 85 00 a5 c6 f0 65 81 00 80 50 82 10 81 05 81 20 90 10 6f 00 3f 01 13 f1 a5 c1 f0 65 70 01 f0 55 13 61 a5 c3 f0 65 85 00 60 01 81 50 50 10 6f 01 3f 00 14 13 a5 c2 f0 65 85 00 c0 18 81 50 a5 b8 f1 1e f0 55 a5 c3 f0 65 85 00 60 00 81 50 50 10 6f 01 90 10 6f 00 3f 00 13 49 a5 c2 f0 65 a5 b0 f0 1e f0 65 8a 00 a5 c2 f0 65 a5 b8 f0 1e f0 65 8b 00 60 00 a5 80 f0 1e da b8 a5 c2 f0 65 85 00 a5 c4 f0 65 81 00 80 50 82 10 81 05 81 20 90 10 6f 00 3f 01 14 6f a5 c2 f0 65 70 01 f0 55 12 49 c0 07 a5 c0 f0 55 a5 c0 f0 65 a5 b0 f0 1e f0 65 8a 00 a5 c0 f0 65 a5 b8 f0 1e f0 65 8b 00 a5 c0 f0 65 a5 a8 f0 1e f0 65 a5 80 f0 1e f0 65 da b8 60 0a f0 15 a5 c0 f0 65 85 00 a5 c0 f0 65 a5 a8 f0 1e f0 65 86 00 60 08 81 00 80 60 80 14 81 50 a5 a8 f1 1e f0 55 a5 c0 f0 65 a5 a8 f0 1e f0 65 85 00 60 20 81 00 80 50 82 10 81 05 81 20 3f 00 14 f1 a5 c0 f0 65 85 00 60 00 81 50 a5 a8 f1 1e f0 55 a5 c0 f0 65 85 00 60 32 81 50 50 10 6f 01 90 10 6f 00 3f 00 14 6f 15 07 81 00 a5 c7 62 01 8e 25 fe 1e f0 65 00 ee 62 01 63 00 83 04 81 25 31 00 15 1b 80 30 00 ee a5 c7 fe 1e f6 55 66 00 82 00 82 15 3f 01 15 53 83 00 83 06 84 10 65 01 82 30 82 45 3f 01 15 4d 84 0e 85 0e 15 3f 80 45 86 54 15 2f f5 65 80 60 00 ee 82 00 80 15 3f 00 15 59 80 20 00 ee a5 7d f0 33 f2 65 f0 29 d3 45 73 06 f1 29 d3 45 73 06 f2 29 d3 45 00 ee 28 63 29 00 00 00 10 00 00 00 00 00 00 38 28 38 00 00 00 00 54 00 44 00 54 00 00 92 00 00 82 00 00 92 00 92 54 38 fe 38 54 92 00 08 08 08 08 08 08 08 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00";


/**
*
*/
QUnit.test( "cpu can be instantiated ", function( assert ) {
    var cpu = new Chip8VM();
    assert.notEqual(cpu, null);
});


/**
*
*/
QUnit.test( "cpu cannot be started without a program ", function( assert ) {
    var cpu = new Chip8VM();
    var exeptionThrown = false;
    try {
        cpu.start()
    } catch(e) {
        exeptionThrown = true;
    }
    assert.ok(exeptionThrown);
});


/**
*
*/
QUnit.test( "cpu can dump _memory ", function( assert ) {
    var cpu = new Chip8VM();
    var str = cpu._dump_memory();
    assert.ok(str.length > 0);
});

/**
*
*/
QUnit.test( "cpu is initialized properly when constructed ", function( assert ) {
    var cpu = new Chip8VM();
    assert.ok(cpu._memory);
    assert.equal(cpu.iReg,0);
    assert.ok(cpu.vRegs);
    assert.ok(cpu.stack);
    assert.equal(cpu.stackPtr,0);
    assert.equal(cpu.counter, 0);
});


/**
*
*/
QUnit.test( "cpu can load a program from String ", function( assert ) {
    var cpu = new Chip8VM();
    cpu.loadFromHexString(PROGRAM_1);
    //console.log(cpu._dump_memory());
    assert.ok(cpu.programLoaded);
});

/**
*
*/
QUnit.test( "Chip8VM can start", function( assert ) {
    var cpu = new Chip8VM();
    cpu.loadFromHexString("20 02");
    cpu.start();
    assert.ok(true);
});


QUnit.test( "Evaluate CALL SUBROUTINE", function( assert ) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("20 02");
    setTimeout(function() {
        console.log('STACK PTR',cpu.stackPtr)
        assert.equal(cpu.stackPtr ,1 , "Stack ptr check");
        //assert.equal(cpu.stack[1] ,2, "cpu stack check");
        assert.equal(cpu.counter, 4, "counter check");
        done1();
    }, 500 );
});


QUnit.test( "Evaluate CALL SUBROUTINE until stack depth exceeded", function( assert ) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02 20 02");
    setTimeout(function() {
        assert.ok(cpu.errors.length > 0,"Exception test");
        done1();
    }, 500 );
});

/**
*
*/
QUnit.test( "Evaluate JUMP TO LOCATION", function( assert ) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("10 FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,257 , "Counter check");
        done1();
    }, 500 );
});

/**
*
*/
QUnit.test( "Evaluate JUMP TO LOCATION 2", function( assert ) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("1F FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,4095 , "Counter check");
        done1();
    }, 500 );
});

/**
*
*/
QUnit.test( "Evaluate RETURN FROM SUBROUTINE", function( assert ) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("20 06 00 00 00 00 00 EE");
    setTimeout(function() {
        assert.equal(cpu.counter ,4 , "Counter check");
        assert.equal(cpu.stackPtr ,0 , "Stack ptr check");
        done1();
    }, 500 );
});

QUnit.test("TEST 3xkk Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0xFF;
    cpu.evalHexCode("30 FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,6 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 3xkk scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[10] = 0xFF;
    cpu.evalHexCode("3A FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,6 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 3xkk Scenario 3 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[10] = 0xFA;
    cpu.evalHexCode("3A FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,4 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 4xkk Scenario 1 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[10] = 0xFA;
    cpu.evalHexCode("4A FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,6 , "Counter check");
        done1();
    }, 500 );
});


QUnit.test("TEST 4xkk Scenario 2 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[10] = 0xFF;
    cpu.evalHexCode("4A FF");
    setTimeout(function() {
        assert.equal(cpu.counter ,4 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 5xy0 Scenario 1 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0xFF;
    cpu.vRegs[1] = 0xFF;
    cpu.evalHexCode("50 10");
    setTimeout(function() {
        assert.equal(cpu.counter ,6 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 5xy0 Scenario 2 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0xFF;
    cpu.vRegs[1] = 0xAA;
    cpu.evalHexCode("50 10");
    setTimeout(function() {
        assert.equal(cpu.counter ,4 , "Counter check");
        done1();
    }, 500 );
});

QUnit.test("TEST 6xkk Scenario 1 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("66 AA");
    setTimeout(function() {
        assert.equal(cpu.vRegs[6], 0xAA);
        done1();
    }, 500 );
});

QUnit.test("TEST 7xkk Scenario 1 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 15;
    cpu.evalHexCode("70 FF");
    setTimeout(function() {
        assert.equal(cpu.vRegs[0], 270);
        done1();
    }, 500 );
});


QUnit.test("TEST 7xkk Scenario 2 ", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[10] = 0xFF;
    cpu.evalHexCode("7A FF");
    setTimeout(function() {
        assert.equal(cpu.vRegs[10], 510);
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy0 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFF;
    cpu.evalHexCode("80 10");
    setTimeout(function() {
        assert.equal(cpu.vRegs[0],0xFF );
        done1();
    }, 500 );
});



QUnit.test("TEST 8xy1 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFF;
    cpu.vRegs[2] = 0xFF;
    cpu.evalHexCode("81 21");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xFF );
        done1();
    }, 500 );
});


QUnit.test("TEST 8xy1 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0F;
    cpu.vRegs[2] = 0x00;
    cpu.evalHexCode("81 21");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x0F );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy1 Scenario 3", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0F;
    cpu.vRegs[2] = 0xF0;
    cpu.evalHexCode("81 21");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xFF );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy2 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0F;
    cpu.vRegs[2] = 0xF0;
    cpu.evalHexCode("81 22");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x00 );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy2 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xF0;
    cpu.vRegs[2] = 0xF0;
    cpu.evalHexCode("81 22");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xF0 );
        done1();
    }, 500 );
});



QUnit.test("TEST 8xy3 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0F;
    cpu.vRegs[2] = 0xF0;
    cpu.evalHexCode("81 23");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xFF );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy3 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xF0;
    cpu.vRegs[2] = 0xF0;
    cpu.evalHexCode("81 23");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x00 );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy3 Scenario 3", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x01;
    cpu.vRegs[2] = 0x00;
    cpu.evalHexCode("81 23");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x01 );
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy3 Scenario 4", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x11;
    cpu.vRegs[2] = 0x12;
    cpu.evalHexCode("81 23");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x03 );
        done1();
    }, 500 );
});


QUnit.test("TEST 8xy4 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFF;
    cpu.vRegs[2] = 0xFF;
    cpu.evalHexCode("81 24");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xFE );
        assert.equal(cpu.vRegs[15], 0x01)
        done1();
    }, 500 );
});



QUnit.test("TEST 8xy4 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFF;
    cpu.vRegs[2] = 0x01;
    cpu.evalHexCode("81 24");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x00 );
        assert.equal(cpu.vRegs[15], 0x01)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy4 Scenario 3", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFE;
    cpu.vRegs[2] = 0x01;
    cpu.evalHexCode("81 24");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0xFF );
        assert.equal(cpu.vRegs[15], 0x00)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy5 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0A;
    cpu.vRegs[2] = 0x01;
    cpu.evalHexCode("81 25");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x09 );
        assert.equal(cpu.vRegs[15], 0x01)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy5 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x01;
    cpu.vRegs[2] = 0x0A;
    cpu.evalHexCode("81 25");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x09 );
        assert.equal(cpu.vRegs[15], 0x00)
        done1();
    }, 500 );
});


QUnit.test("TEST 8xy6 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x02;
    cpu.evalHexCode("81 06");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x01 );
        assert.equal(cpu.vRegs[15],0x00);
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy6 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x01;
    cpu.evalHexCode("81 06");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1],0x00 );
        assert.equal(cpu.vRegs[15],0x01)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy6 Scenario 3", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x0F;
    cpu.evalHexCode("81 06");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0x07 );
        assert.equal(cpu.vRegs[15],0x01)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy6 Scenario 4", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xF0;
    cpu.evalHexCode("81 06");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0x78 );
        assert.equal(cpu.vRegs[15],0x00)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy7 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x02;
    cpu.vRegs[2] = 0x0F;
    cpu.evalHexCode("81 27");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0x0D );
        assert.equal(cpu.vRegs[15],0x01)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xy7 Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x08;
    cpu.vRegs[2] = 0x01;
    cpu.evalHexCode("81 27");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0x07 );
        assert.equal(cpu.vRegs[15],0x00)
        done1();
    }, 500 );
});

QUnit.test("TEST 8xyE Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0x01;
    cpu.evalHexCode("81 0E");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0x02 );
        assert.equal(cpu.vRegs[15],0x00);
        done1();
    }, 500 );
});

QUnit.test("TEST 8xyE Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 0xFF;
    cpu.evalHexCode("81 0E");
    setTimeout(function() {
        assert.equal(cpu.vRegs[1], 0xFE);
        assert.equal(cpu.vRegs[15],0x01);
        done1();
    }, 500 );
});

QUnit.test("TEST Annn Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("AF FF");
    setTimeout(function() {
        assert.equal(cpu.iReg, 0xFFF);
        done1();
    }, 500 );
});

QUnit.test("TEST Annn Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("A0 10");
    setTimeout(function() {
        assert.equal(cpu.iReg, 0x010);
        done1();
    }, 500 );
});


QUnit.test("TEST Annn Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 1;
    cpu.evalHexCode("B0 FE");
    setTimeout(function() {
        assert.equal(cpu.counter, 0xFF + 2);
        done1();
    }, 500 );
});


QUnit.test("TEST Annn Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0xE;
    cpu.evalHexCode("B0 01");
    setTimeout(function() {
        assert.equal(cpu.counter, 0x0F + 2);
        done1();
    }, 500 );
});

QUnit.test("TEST  Cxkk Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("C5 FF");
    setTimeout(function() {
        assert.ok(cpu.vRegs[5] > 0);
        done1();
    }, 500 );
});

QUnit.test("TEST Cxkk Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("C5 00");
    setTimeout(function() {
        assert.ok(cpu.vRegs[5] == 0);
        done1();
    }, 500 );
});

QUnit.test("TEST Ex9E - SKP Vx Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 1;
    cpu._key_pressed = 1;
    cpu.evalHexCode("E1 9E");
    setTimeout(function() {
        assert.equal(cpu.counter, 6);
        done1();
    }, 500 );
});

QUnit.test("TEST Ex9E - SKP Vx Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 1;
    cpu._key_pressed = 5;
    cpu.evalHexCode("E1 9E");
    setTimeout(function() {
        assert.equal(cpu.counter, 4);
        done1();
    }, 500 );
});

QUnit.test("TEST Ex9E - SKP Vx Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 1;
    cpu._key_pressed = 1;
    cpu.evalHexCode("E1 A1");
    setTimeout(function() {
        assert.equal(cpu.counter, 4);
        done1();
    }, 500 );
});

QUnit.test("TEST Ex9E - SKP Vx Scenario 2", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[1] = 1;
    cpu._key_pressed = 2;
    cpu.evalHexCode("E1 A1");
    setTimeout(function() {
        assert.equal(cpu.counter, 6);
        done1();
    }, 500 );
});


QUnit.test("TEST Fx0A Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var done2 = assert.async();
    var cpu = new Chip8VM();
    cpu.evalHexCode("F1 0A");
    setTimeout(function() {
        cpu._key_pressed = 5;
        done1();
        setTimeout(function() {
            assert.ok(cpu.virtualInterupt);
            assert.equal(cpu.vRegs[1],5);
            done2();
        }, 500 );
    }, 500 );
});


QUnit.test("TEST Fx1E Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var done2 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[5] = 0xFE;
    cpu.iReg = 0x01;
    cpu.evalHexCode("F5 1E");
    setTimeout(function() {
        assert.equal(cpu.iReg, 0xFF );
        done1();
    }, 500 );
});

QUnit.test("TEST Fx29 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0x0A;
    cpu.evalHexCode("F0 29");
    setTimeout(function() {
        assert.equal(cpu.iReg, 0x0A );
        done1();
    }, 500 );
});


QUnit.test("TEST Fx55 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    cpu.vRegs[0] = 0x00;
    cpu.vRegs[1] = 0x01;
    cpu.vRegs[2] = 0x02;
    cpu.vRegs[3] = 0x03;
    cpu.vRegs[4] = 0x04;
    cpu.vRegs[5] = 0x05;
    cpu.vRegs[6] = 0x06;
    cpu.vRegs[7] = 0x07;
    cpu.vRegs[8] = 0x08;
    cpu.vRegs[9] = 0x09;
    cpu.vRegs[10] = 0x0A;
    var index = 1536
    cpu.iReg = index;
    cpu.evalHexCode("FA 55");
    setTimeout(function() {
        assert.equal(cpu.getDataMemory(index), 0x00);
        assert.equal(cpu.getDataMemory(index+1), 0x01);
        assert.equal(cpu.getDataMemory(index+2), 0x02);
        assert.equal(cpu.getDataMemory(index+3), 0x03);
        assert.equal(cpu.getDataMemory(index+4), 0x04);
        assert.equal(cpu.getDataMemory(index+5), 0x05);
        assert.equal(cpu.getDataMemory(index+6), 0x06);
        assert.equal(cpu.getDataMemory(index+7), 0x07);
        assert.equal(cpu.getDataMemory(index+8), 0x08);
        assert.equal(cpu.getDataMemory(index+9), 0x09);
        assert.equal(cpu.getDataMemory(index+10), 0x0A);
        done1();
    }, 500 );
});

QUnit.test("TEST Fx65 Scenario 1", function(assert) {
    assert.ok(true);
    var done1 = assert.async();
    var cpu = new Chip8VM();
    var index = 500;
    cpu.setDataMemory(index , 0xFF);
    cpu.setDataMemory(index+1,0xFF);
    cpu.setDataMemory(index+2,0xFF);
    cpu.setDataMemory(index+3,0xFF);
    cpu.setDataMemory(index+4,0xFE);
    cpu.setDataMemory(index+5,0xFA);
    cpu.setDataMemory(index+6,0xF9);
    cpu.setDataMemory(index+7,0xF8);
    cpu.setDataMemory(index+8,0xF7);
    cpu.setDataMemory(index+9,0xF6);
    cpu.iReg = index;
    cpu.evalHexCode("FA 65");
    setTimeout(function() {
        assert.equal(cpu.vRegs[0], 0xFF);
        assert.equal(cpu.vRegs[1], 0xFF);
        assert.equal(cpu.vRegs[2], 0xFF);
        assert.equal(cpu.vRegs[3], 0xFF);
        assert.equal(cpu.vRegs[4], 0xFE);
        assert.equal(cpu.vRegs[5], 0xFA);
        assert.equal(cpu.vRegs[6], 0xF9);
        assert.equal(cpu.vRegs[7], 0xF8);
        assert.equal(cpu.vRegs[8], 0xF7);
        assert.equal(cpu.vRegs[9], 0xF6);
        done1();
    }, 500 );
});
